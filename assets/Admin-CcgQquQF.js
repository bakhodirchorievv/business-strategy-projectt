import{r as a,j as t}from"./index-C38-xNkK.js";import{o as F,a as u,b as z,s as H,e as J,f as K,c as Q,d,g as V,r as f,h as x,u as A,i as L,j as X,k as j,l as Y,m as k,n as S}from"./FirebaseConfig-BfNWVVN1.js";const Z=()=>{const[v,D]=a.useState(""),[g,w]=a.useState(""),[c,n]=a.useState(null),[y,m]=a.useState(!1),C=async()=>{try{await z(u,v,g),n("Successfully logged in!")}catch(o){console.error(o),n("Error logging in")}},b=async()=>{try{await H(u,J),n("Successfully logged in!")}catch(o){console.error(o),n("Error logging in!")}},I=async()=>{try{await K(u),n("Successfully logged out!")}catch(o){console.error(o),n("Error logging out!")}};return a.useEffect(()=>{const o=F(u,p=>{m(!!p)});return()=>o()},[]),a.useEffect(()=>{if(c){const o=setTimeout(()=>{n(null)},3e3);return()=>clearTimeout(o)}},[c]),t.jsx(t.Fragment,{children:y?t.jsx("button",{className:"logOutFire",onClick:I,children:"Log Out"}):t.jsxs("div",{style:{backgroundColor:"#333"},children:[c&&t.jsx("div",{className:"message",children:c}),t.jsx("input",{placeholder:"Email...",onChange:o=>D(o.target.value)}),t.jsx("input",{placeholder:"Password...",type:"password",onChange:o=>w(o.target.value)}),t.jsx("br",{}),t.jsx("button",{onClick:C,children:"Sign In"}),t.jsx("button",{onClick:b,children:"Sign In With Google"})]})})},te=()=>{const[v,D]=a.useState([]),[g,w]=a.useState(""),[c,n]=a.useState(""),[y,m]=a.useState(""),[C,b]=a.useState(""),[I,o]=a.useState(null),[p,R]=a.useState(null),[E,T]=a.useState(null),U=a.useRef(null),N=a.useRef(null),W=Q(d,"cases"),i=async()=>{try{const s=(await V(W)).docs.map(r=>({...r.data(),id:r.id}));D(s)}catch(e){console.error(e)}};a.useEffect(()=>{i();const e=F(u,s=>{o(s?s.email:null)});return()=>e()},[]);const O=async()=>{var e,s;if(p&&c&&g){const r=f(x,`images/${p.name}`);await A(r,p);const l=await L(r);try{await X(W,{title:g,desc:c,imageUrl:l,userId:(s=(e=u)==null?void 0:e.currentUser)==null?void 0:s.uid}),i(),w(""),n(""),R(null),U.current&&(U.current.value="")}catch(h){console.error(h)}}else console.error("Something is not selected (image or title or desc)")},P=async(e,s)=>{try{const r=j(d,"cases",e);if(await Y(r),s){const l=f(x,s);try{await k(l),console.log("Image deleted successfully")}catch(h){console.error("Error deleting image: ",h)}}i(),console.log("Case and image deleted")}catch(r){console.error("Error deleting Case or image: ",r)}},G=async e=>{try{const s=j(d,"cases",e);await S(s,{title:C}),i(),b(""),console.log("Case updated")}catch(s){console.error("while updating title",s)}},$=async(e,s)=>{if(E)try{const r=f(x,`images/${E.name}`);await A(r,E);const l=await L(r),h=j(d,"cases",e);if(s){const q=f(x,s);await k(q)}await S(h,{imageUrl:l}),i(),T(null),N.current&&(N.current.value=""),console.log("Image updated")}catch(r){console.error("Error updating image: ",r)}else console.error("No image selected for update")},B=async(e,s)=>{const r=f(x,s);try{await k(r);const l=j(d,"cases",e);await S(l,{imageUrl:""}),i(),console.log("Image deleted")}catch(l){console.error("Error deleting image: ",l)}},M=async e=>{try{const s=j(d,"cases",e);await S(s,{desc:y}),i(),m(""),console.log("Case date updated")}catch(s){console.error("while updating release date",s)}};return t.jsxs("div",{className:"adminWrapper",children:[t.jsx(Z,{}),I&&t.jsxs("div",{className:"controlAuthWrapper",children:[t.jsx("h2",{className:"addCaseTitle",children:"Add New Case"}),t.jsx("input",{type:"text",placeholder:"Case title...",value:g,onChange:e=>w(e.target.value)}),t.jsx("input",{type:"text",placeholder:"Case desc...",value:c,onChange:e=>n(e.target.value)}),t.jsx("input",{type:"file",ref:U,onChange:e=>R(e.target.files?e.target.files[0]:null)}),t.jsx("button",{onClick:O,children:"Submit Case"})]}),t.jsx("div",{className:"controlDataWrapper",children:v.map(e=>t.jsx("div",{className:"caseItemWrapperFire",children:I&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{style:{color:"white"},children:e.title}),t.jsx("p",{children:e.desc}),e.imageUrl&&t.jsx("img",{className:"caseImgFire",src:e.imageUrl,alt:e.title,width:"500"}),t.jsx("button",{onClick:()=>P(e.id,e.imageUrl),children:"Delete Case"}),t.jsx("br",{}),t.jsx("input",{onChange:s=>b(s.target.value),type:"text",value:C,placeholder:"new title..."}),t.jsx("button",{onClick:()=>G(e.id),children:"Update Title"}),t.jsx("br",{}),t.jsx("input",{type:"file",ref:N,onChange:s=>T(s.target.files?s.target.files[0]:null)}),t.jsx("button",{onClick:()=>$(e.id,e.imageUrl),children:"Update Image"}),t.jsx("br",{}),t.jsx("button",{onClick:()=>B(e.id,e.imageUrl),children:"Delete Image"}),t.jsx("br",{}),t.jsx("input",{type:"text",onChange:s=>m(s.target.value),value:y,placeholder:"new desc..."}),t.jsx("button",{onClick:()=>M(e.id),children:"Update Desc"})]})},e.id))})]})};export{te as default};
